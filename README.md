# 基于树莓派的智能灯光与语音交互系统

## 项目概述

本项目是一个基于树莓派的智能灯光与语音交互系统。系统通过使用树莓派4B与WS2812B灯带，结合语音识别与控制，实现智能灯光的远程操控、动态模式控制与语音交互。用户可以通过手机APP或语音命令控制灯光的亮度、颜色及模式，提供便捷的智能家居体验。

![实物展示图](images/LightStrip.png)  <!-- 替换为灯光亮的实物图（LightStrip.png） -->

## 主要功能

- **远程控制**：用户可以通过Android应用远程控制灯光模式，支持7种预设的动态灯光模式（如彩虹渐变、呼吸灯、音乐律动等）及自定义参数设置。
- **语音控制**：集成百度语音识别API与DeepSeek大模型，实现通过语音控制灯光的功能，如开关灯、调整亮度与颜色。
- **多设备支持**：系统支持绑定多个设备，用户可以在多个树莓派设备间进行跨设备协同控制。
- **低成本部署**：采用树莓派与WS2812B灯带，硬件成本低，支持本地服务器部署，结合Cloudflare Tunnel实现公网穿透。
- **工业级安全架构**：数据传输全程加密，支持JWT令牌认证与BCrypt加密存储，保障用户隐私与设备安全。

## 技术架构

### 移动端
- **技术栈**：Kotlin, Jetpack Compose, Retrofit2, Room

### 服务器端
- **技术栈**：Node.js, Express.js, MongoDB, WebSocket, Cloudflare Tunnel

### 硬件端
- **硬件**：树莓派4B, WS2812B灯带, rpi_ws281x库
- **语音控制**：百度语音API, DeepSeek大模型, PyAudio

### 网络层
- **协议**：HTTPS (阿里云SSL证书), WebSocket, Cloudflare CDN加速

## 系统部署

### 公网暴露
通过Cloudflare Tunnel将本地服务器映射至公网，域名为 `uphengbai77.xyz`，支持通过HTTPS与WebSocket进行安全通信。

### 硬件连接
- **树莓派端**：使用GPIO18控制WS2812B灯带，确保灯带与树莓派之间的电源与信号连接稳定。
- **语音设备**：USB麦克风接入树莓派，用于采集语音输入，支持双麦降噪。

## 项目实现

### 手机APP界面

以下是APP各个界面的截图，展示了用户如何通过移动端控制灯光设备。

#### 1. **设备管理界面**
![设备管理界面](images/APP_Device.png)

#### 2. **登录界面**
![登录界面](images/APP_Login.jpg)

#### 3. **主界面**
![主界面](images/APP_Main.jpg)

#### 4. **注册界面**
![注册界面](images/APP_Register.jpg)

#### 5. **设置界面**
![设置界面](images/APP_Setting.jpg)

#### 6. **用户界面**
![用户界面](images/APP_User.jpg)

### 动态灯光控制引擎
系统支持七种灯光模式，包括：
1. **常亮模式**：支持静态颜色与亮度控制。
2. **彩虹跑马模式**：实现彩虹颜色渐变与拖尾效果。
3. **星星闪烁模式**：随机闪烁灯珠，模拟星空效果。
4. **波动模式**：模拟水波或波动效果。
5. **彩虹流动模式**：实现高速流动效果。
6. **呼吸模式**：模拟呼吸灯效果，动态调节亮度。
7. **水波纹模式**：模拟水波扩散效果，支持多个涟漪同时存在。

### 语音控制
集成百度语音API，实现语音命令控制。用户可以通过语音命令实现对灯光的控制，如“开灯”，“调成蓝色呼吸灯”等。

### 安全性
- **传输层安全**：所有通信均通过HTTPS协议加密，使用阿里云SSL证书保障数据安全。
- **认证与授权**：使用JWT令牌机制进行用户身份认证，确保只有授权用户能够控制设备。
- **设备绑定**：设备需要进行邮箱验证码验证后才能绑定，保障设备安全性。

## 安装与使用

### 依赖安装
1. 安装树莓派系统并确保网络连接。
2. 安装 `rpi_ws281x` 库，用于控制WS2812B灯带。
3. 安装 `pyaudio` 和其他必要的依赖，支持语音识别功能。

### 系统启动
1. 启动树莓派设备，运行 `main.py` 文件启动智能灯光与语音交互系统。
2. 通过移动端应用连接并控制灯光，或通过语音命令进行控制。

### 配置文件
确保在启动系统前修改配置文件，设置正确的服务器URL和设备ID。

## 贡献

欢迎提出问题、建议和贡献代码！你可以通过Fork此项目并提交Pull Request进行贡献。

## 许可协议

本项目采用MIT许可证，详情请参阅 [LICENSE](LICENSE) 文件。

